---
title: "Group Statistics and Plots- StateSt"
author: "Bruce Wang"
date: "11/15/2019"
output: html_document
editor_options: 
  chunk_output_type: console
---

## Group Statistics
```{r group Statistics}
df6_StateSt %>% group_by(BinStartTime) %>% tally()
df6_StateSt %>% group_by(SignalId) %>% tally()
df6_StateSt %>% group_by(ApproachId) %>% tally()
df6_StateSt %>% group_by(ArrivalsOnGreen) %>% tally()
df6_StateSt %>% group_by(ArrivalsOnRed) %>% tally()
df6_StateSt %>% group_by(ArrivalsOnYellow) %>% tally()
df6_StateSt %>% group_by(TotalVolume) %>% tally()
df6_StateSt %>% group_by(PlatoonRatio) %>% tally()
df6_StateSt %>% group_by(SplitFailures) %>% tally()
df6_StateSt %>% group_by(GapOuts) %>% tally()
df6_StateSt %>% group_by(ForceOffs) %>% tally()
df6_StateSt %>% group_by(TotalRedLightViolations) %>% tally()
df6_StateSt %>% group_by(TotalCycles) %>% tally()
```

## ArrivalsOnGreen Plots {.tabset}
### AOG Histogram
```{r AOG Histogram}
ggplot(df6_StateSt, aes(x = ArrivalsOnGreen)) + geom_histogram(stat = "bin", binwidth = 20, color = "black", fill = "Green") 
```

### AOG by SignalId
```{r AOG by SignalId}
ggplot(df6_StateSt, aes(x = ArrivalsOnGreen, fill = SignalId)) + geom_bar(color = "black", fill = "Green") + facet_wrap(~SignalId)
```

### AOG by ApproachId
```{r AOG by ApproachId}
ggplot(df6_StateSt, aes(x = ArrivalsOnGreen, fill = AprroachId)) + geom_bar(color = "black", fill = "Green") + facet_wrap(~ApproachId)
```

### AOG VS TotalVolume
```{r AOG VS TotalVolume}
ggplot(df6_StateSt, aes(x = TotalVolume, y = ArrivalsOnGreen)) +
  geom_point(alpha = 0.1)
```

### AOG VS PlatoonRatio
```{r AOG VS PlatoonRatio}
ggplot(df6_StateSt, aes(x = PlatoonRatio, y = ArrivalsOnGreen, color = SplitFailures)) +
  geom_point(alpha = 0.1) +
  facet_wrap(~SplitFailures)
```

### AOG VS PlatoonRatio by SplitFailures
```{r AOG VS PlatoonRatio by SplitFailures}
ggplot(df6_StateSt, aes(x = PlatoonRatio, y = ArrivalsOnGreen, color = SplitFailures)) +
  geom_point(alpha = 0.1) +
  facet_wrap(~SplitFailures)
```

### AOG VS TotalVolume per Cycle
```{r AOG VS TotalVolume per Cycle}
ggplot(df6_StateSt, aes(x = TotalVolume/TotalCycles, y = (ArrivalsOnGreen+ArrivalsOnYellow)/TotalVolume)) +
  geom_point(alpha = 0.1)
```

### AMPeak AOG VS TotalVolume
```{r AMPeak AOG VS TotalVolume}
ggplot(dfAMPeak_StateSt, aes(x = TotalVolume, y = (ArrivalsOnGreen+ArrivalsOnYellow)/TotalVolume)) +
  geom_point(alpha = 0.1)
```

### MidDay AOG VS TotalVolume
```{r MidDay AOG VS TotalVolume}
ggplot(dfMidDay_StateSt, aes(x = TotalVolume, y = (ArrivalsOnGreen+ArrivalsOnYellow)/TotalVolume)) +
  geom_point(alpha = 0.1)
```

## PlatoonRatio Plots {.tabset}
### PlatoonRatio Histogram
```{r PlatoonRatio Histogram}
ggplot(df6_StateSt, aes(x = PlatoonRatio)) + geom_histogram(stat = "bin", binwidth = 0.05, color = "black", fill = "Blue")
```

### PlatoonRatio by SignalId
```{r PlatoonRatio by SignalId}
ggplot(df6_StateSt, aes(x = PlatoonRatio, fill = SignalId)) + geom_bar(color = "black", fill = "Blue") + facet_wrap(~SignalId)
```

### PlatoonRatio by ApproachId
```{r PlatoonRatio by ApproachId}
ggplot(df6_StateSt, aes(x = PlatoonRatio, fill = ApproachId)) + geom_bar(color = "black", fill = "Blue") + facet_wrap(~ApproachId)
```

### PlatoonRatio VS PercentAOG
```{r PlatoonRatio VS PercentAOG}
ggplot(df6_StateSt, aes(x = PlatoonRatio, y = PercentAOG, color = SplitFailures)) +
  geom_point(alpha = 0.1)
```

### PlatoonRatio VS PercentAOG by SplitFailures
```{r PlatoonRatio VS PercentAOG by SplitFailures}
ggplot(df6_StateSt, aes(x = PlatoonRatio, y = PercentAOG, color = SplitFailures)) +
  geom_point(alpha = 0.1) + 
  facet_wrap(~SplitFailures) 
```

## SplitFailures Plots {.tabset}
### SplitFailures Histogram
```{r SF Histogram}
ggplot(df6_StateSt, aes(x = SplitFailures)) + geom_histogram(stat = "bin", binwidth = 0.5, color = "black", fill = "Red")
```

### SplitFailures by SignalId
```{r SF by SignalId}
ggplot(df6_StateSt, aes(x = SplitFailures, fill = SignalId)) + geom_bar(color = "black", fill = "Red") + facet_wrap(~SignalId)
```

### SplitFailures by ApproachId
```{r SF by ApproachId}
ggplot(df6_StateSt, aes(x = SplitFailures, fill = ApproachId)) + geom_bar(color = "black", fill = "Red") + facet_wrap(~ApproachId)
```

### SplitFailures per Cycle
```{r Avg SF per Cycle}
ggplot(df6_StateSt, aes(x = SplitFailures/TotalCycles)) + geom_bar(color = "black", fill = "Red")
```

### SplitFailures VS PlatoonRatio
```{r SplitFailures VS PlatoonRatio}
ggplot(df6_StateSt, aes(x = PlatoonRatio, y = SplitFailures)) +
  geom_point(alpha = 0.1) 
```

### SplitFailures VS TotalVolume
```{r SplitFailures VS TotalVolume}
ggplot(df6_StateSt, aes(x = TotalVolume, y = SplitFailures)) +
  geom_point(alpha = 0.1)
```

### SplitFailures VS TotalVolume per Cycle
```{r SplitFailures VS TotalVolume per Cycle}
ggplot(df6_StateSt, aes(x = TotalVolume/TotalCycles, y = SplitFailures/TotalCycles)) +
  geom_point(alpha = 0.1)
```

## TotalRedLightViolations Plots {.tabset}
### RA Histogram
```{r RA Histogram}
ggplot(df6_StateSt, aes(x = TotalRedLightViolations)) + geom_histogram(stat = "bin", binwidth = 0.5, color = "black", fill = "red")
```

### RedLightViolations by SignalId
```{r RA by SignalId}
ggplot(df6_StateSt, aes(x = TotalRedLightViolations, fill = SignalId)) + geom_bar(color = "black", fill = "Red") + facet_wrap(~SignalId)
```

### RedLightViolations by ApproachId
```{r RA by ApproachId}
ggplot(df6_StateSt, aes(x = TotalRedLightViolations, fill = ApproachId)) + geom_bar(color = "black", fill = "Red") + facet_wrap(~ApproachId)
```

### RedLightViolations per Cycle
```{r RA per Cycle}
ggplot(df6_StateSt, aes(x = TotalRedLightViolations/TotalCycles)) + geom_bar(color = "black", fill = "Red")
```

### RedLightViolations VS TotalVolume
```{r RA VS TotalVolume}
ggplot(df6_StateSt, aes(x = TotalVolume, y = TotalRedLightViolations)) +
  geom_point(alpha = 0.1)
```

### RedLightViolations VS TotalVolume per Cycle
```{r RA VS TotalVolume per Cycle}
ggplot(df6_StateSt, aes(x = TotalVolume/TotalCycles, y = TotalRedLightViolations/TotalCycles)) +
  geom_point(alpha = 0.1)
```

## GapOuts Plots {.tabset}
### GapOuts Histogram
```{r GapOuts Histogram}
ggplot(df6_StateSt, aes(x = GapOuts)) + geom_histogram(stat = "bin", binwidth = 1, color = "black", fill = "Orange")
```

### GapOuts by SignalId
```{r GapOuts by SignalId}
ggplot(df6_StateSt, aes(x = GapOuts, fill = SignalId)) + geom_bar(color = "black", fill = "Orange") + facet_wrap(~SignalId)
```

### GapOuts by ApproachId
```{r GapOuts by ApproachId}
ggplot(df6_StateSt, aes(x = GapOuts, fill = ApproachId)) + geom_bar(color = "black", fill = "Orange") + facet_wrap(~ApproachId)
```

### GapOuts per Cycle
```{r GapOuts per Cycle}
ggplot(df6_StateSt, aes(x = GapOuts/TotalCycles)) + geom_bar(stat = "bin", binwidth = 0.05, color = "black", fill = "Orange")
```

### GapOuts per Cycle by ApproachId
```{r GapOuts per Cycle by ApproachId}
ggplot(df6_StateSt, aes(x = GapOuts/TotalCycles, fill = ApproachId)) + geom_bar(stat = "bin", binwidth = 0.05, color = "black", fill = "Orange") + facet_wrap(~ApproachId)
```

### GapOuts VS TotalVolume
```{r GapOuts VS TotalVolume}
ggplot(df6_StateSt, aes(x = TotalVolume, y = GapOuts)) +
  geom_point(alpha = 0.1)
```

### GapOuts VS TotalVolume per Cycle
```{r GapOuts VS TotalVolume per Cycle}
ggplot(df6_StateSt, aes(x = TotalVolume/TotalCycles, y = GapOuts/TotalCycles)) +
  geom_point(alpha = 0.1)
```

## ForceOffs Plots {.tabset}
### ForceOffs Histogram
```{r ForceOffs Histogram}
ggplot(df6_StateSt, aes(x = ForceOffs)) + geom_histogram(stat = "bin", binwidth = 1, color = "black", fill = "Orange")
```

### ForceOffs by SignalId
```{r ForceOffs by SignalId}
ggplot(df6_StateSt, aes(x = ForceOffs, fill = SignalId)) + geom_bar(color = "black", fill = "Orange") + facet_wrap(~SignalId)
```

### ForceOffs by ApproachId
```{r ForceOffs by ApproachId}
ggplot(df6_StateSt, aes(x = ForceOffs, fill = ApproachId)) + geom_bar(color = "black", fill = "Orange") + facet_wrap(~ApproachId)
```

### ForceOffs per Cycle
```{r ForceOffs per Cycle}
ggplot(df6_StateSt, aes(x = ForceOffs/TotalCycles)) + geom_bar(stat = "bin", binwidth = 0.05, color = "black", fill = "Orange")
```

### ForceOffs per Cycle by ApproachId
```{r ForceOffs per Cycle by ApproachId}
ggplot(df6_StateSt, aes(x = ForceOffs/TotalCycles, fill = ApproachId)) + geom_bar(stat = "bin", binwidth = 0.05, color = "black", fill = "Orange") + facet_wrap(~ApproachId)
```

### ForceOffs VS TotalVolume
```{r ForceOffs VS TotalVolume}
ggplot(df6_StateSt, aes(x = TotalVolume, y = ForceOffs)) +
  geom_point(alpha = 0.1)
```

### ForceOffs VS TotalVolume per Cycle
```{r ForceOffs VS TotalVolume per Cycle}
ggplot(df6_StateSt, aes(x = TotalVolume/TotalCycles, y = ForceOffs/TotalCycles)) +
  geom_point(alpha = 0.1)
```
