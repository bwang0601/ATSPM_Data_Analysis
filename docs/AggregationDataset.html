<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Bruce Wang" />

<meta name="date" content="2019-12-17" />

<title>Aggregation Dataset</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">ATSPM DATA ANALYSIS</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home Page</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="AggregationDataset.html">Aggregation Dataset</a>
</li>
<li>
  <a href="CombinedAggregation.html">Combined Aggregation Tables</a>
</li>
<li>
  <a href="ShinyAppCode.html">Shiny App</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Aggregation Dataset</h1>
<h4 class="author">Bruce Wang</h4>
<h4 class="date">12/17/2019</h4>

</div>


<div id="loading-libraries" class="section level3">
<h3>Loading Libraries</h3>
<pre class="r"><code>## Load Libraries
library(tidyverse)</code></pre>
<pre><code>## -- Attaching packages -------------------------------------------------------------------------------- tidyverse 1.2.1 --</code></pre>
<pre><code>## v ggplot2 3.2.1     v purrr   0.3.2
## v tibble  2.1.3     v dplyr   0.8.3
## v tidyr   0.8.3     v stringr 1.4.0
## v readr   1.3.1     v forcats 0.4.0</code></pre>
<pre><code>## -- Conflicts ----------------------------------------------------------------------------------- tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(readxl)
library(lubridate)</code></pre>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     date</code></pre>
<pre class="r"><code>library(ggplot2)</code></pre>
</div>
<div id="data-collection" class="section level3">
<h3>Data Collection</h3>
<div id="sample-network-selected" class="section level4">
<h4>Sample Network Selected</h4>
<p>The sample study networks were selected based on the corridor location, available detection, and data integrity. The research team analyzed ten intersections on Fort Union Boulevard corridor in Midvale Utah; seven intersections on the State Street corridor in Provo, Utah; and five intersections on 800 North corridors in Provo, Utah. The table 1,2, and 3 show the location of all three corridors.</p>
<p><strong>TABLE 1. Analysis Intersections on Fort Union Boulevard</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">Signal ID</th>
<th align="left">Cross-Street Name</th>
<th align="left">Signal ID</th>
<th align="left">Cross-Street Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">4029</td>
<td align="left">700 East</td>
<td align="left">4090</td>
<td align="left">2000 East</td>
</tr>
<tr class="even">
<td align="left">7207</td>
<td align="left">900 East</td>
<td align="left">4165</td>
<td align="left">2200 East</td>
</tr>
<tr class="odd">
<td align="left">4301</td>
<td align="left">1090 East</td>
<td align="left">4704</td>
<td align="left">2300 East</td>
</tr>
<tr class="even">
<td align="left">4024</td>
<td align="left">1300 East</td>
<td align="left">4705</td>
<td align="left">2700 East</td>
</tr>
<tr class="odd">
<td align="left">4388</td>
<td align="left">1435 East</td>
<td align="left">4706</td>
<td align="left">3000 East</td>
</tr>
</tbody>
</table>
<p><strong>TABLE 2. Analysis Intersections on State Street</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">Signal ID</th>
<th align="left">Cross-Street Name</th>
<th align="left">Signal ID</th>
<th align="left">Cross-Street Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">6303</td>
<td align="left">800 North</td>
<td align="left">6308</td>
<td align="left">400 North</td>
</tr>
<tr class="even">
<td align="left">6311</td>
<td align="left">Center Street</td>
<td align="left">6313</td>
<td align="left">400 South</td>
</tr>
<tr class="odd">
<td align="left">6314</td>
<td align="left">800 South</td>
<td align="left">6323</td>
<td align="left">1200 South</td>
</tr>
<tr class="even">
<td align="left">6393</td>
<td align="left">1600 North</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><strong>TABLE 1. Analysis Intersections on 800 North</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">Signal ID</th>
<th align="left">Cross-Street Name</th>
<th align="left">Signal ID</th>
<th align="left">Cross-Street Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">6303</td>
<td align="left">State Street</td>
<td align="left">6304</td>
<td align="left">Main Street</td>
</tr>
<tr class="even">
<td align="left">6305</td>
<td align="left">400 East</td>
<td align="left">6306</td>
<td align="left">800 East</td>
</tr>
<tr class="odd">
<td align="left">6399</td>
<td align="left">980 West</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
</div>
<div id="study-time-period-selected" class="section level4">
<h4>Study Time Period Selected</h4>
<p>A high number of split failures typically occur during the PM peak due to the relatively high volume of traffic on the roadway. To avoid data with a high number of split fails, the research team decided to look at the AM peak period. If many split failures occur diring this period, it is more likely that the signal is not performing well. WE also chose to look at an afternoon period as a “contral” period. The chosen periods were the AM Peak ()7:00-09:00) and Mid-Day (12:00-14:00) on Tuesdays and Wednesdays in March, July, and October in 2018. The days chose can determine if signal performance has changed over time. By looking at Tuesdays and Wednesdays, two days that are very similar regarding traffic, and it will be able to identify if there are changes to performance over time. Figure 2 shows the selected days for the Study.</p>
<div class="figure">
<img src="img/Picture2.PNG" alt="FIGURE 2. SELECTED DAYS FOR THE SAMPLE STUDY." />
<p class="caption"><strong>FIGURE 2. SELECTED DAYS FOR THE SAMPLE STUDY.</strong></p>
</div>
</div>
</div>
<div id="creating-an-analysis-dataset" class="section level3 tabset">
<h3>Creating an Analysis Dataset</h3>
<p>This script is to create the group dataset of signals on FtUnion corridor, 800 N, and State Street</p>
<p>There are total 10 signals and 20 approaches included on the FtUnion corrdior</p>
<p>There are total 5 signals and 10 approaches included on the 800N corrdior</p>
<p>There are total 7 signals and 13 approaches (SignalId = 6323 hase only SBT) included on the State Street corrdior</p>
<div id="red-light-actuation" class="section level4">
<h4>Red Light Actuation</h4>
<p>The Red Ligh Actuation metric plots vehicle arrivals during the red portions of an intersection’s movements where the speed of the vehicle is interpreted to be too fast to stop before entering the intersection. It provides users with a visual indication of occurrences, violationsm and several related statistics. Also, it will identify engineering countermeasures to address red light running.</p>
<pre class="r"><code># Safety aggregation table: Red Light Actuation
RA_flies &lt;- list(FtUnion = &quot;data/FtUnion/FtUnion_RedActuation.xls&quot;,
                 N800 = &quot;data/800N/800N_RedActuation.xls&quot;,
                 StateSt = &quot;data/StateSt/StateSt_RedActuation.xls&quot;)

RA &lt;- lapply(RA_flies, read_xls) %&gt;%
  bind_rows(.id = &quot;Corridor&quot;) %&gt;%
  mutate(
    BinStartTime = as_datetime(BinStartTime),
    SignalId = as.numeric(SignalId)
  ) %&gt;%
  write_rds(&quot;RA.rds&quot;)</code></pre>
</div>
<div id="purdue-coordination-diagram" class="section level4">
<h4>Purdue Coordination Diagram</h4>
<p>The Purdue Coordination Diagram is a tool to analyze performance measures that plots vehicle arrivals against the current movement(green, yellow, red) and traffic flow in vehicles per hour using the percentage of vehicles that arrive on green and the platoon ratios. This metric allows the analyst to optimize the offsets, identify over splits or under-saturated splits, and visualize the impacts of queuing and different phase actuations.</p>
<pre class="r"><code># Purdue Coordination Diagram aggregation table: ArrivalOnGreen, ArrivalOnRed, and Platoon Ratio
PCD_flies &lt;- list(FtUnion = &quot;data/FtUnion/FtUnion_PCD.xls&quot;,
                 N800 = &quot;data/800N/800N_PCD.xls&quot;,
                 StateSt = &quot;data/StateSt/StateSt_PCD.xls&quot;)

PCD &lt;- lapply(PCD_flies, read_xls) %&gt;%
  bind_rows(.id = &quot;Corridor&quot;) %&gt;%
  mutate(
    BinStartTime = as_datetime(BinStartTime),
    SignalId = as.numeric(SignalId),
    TotalVolume = as.numeric(TotalVolume),
    PlatoonRatio = as.numeric(PlatoonRatio)
  ) %&gt;%
  write_rds(&quot;PCD.rds&quot;)</code></pre>
</div>
<div id="split-failure" class="section level4">
<h4>Split Failure</h4>
<p>The Purdue Split Failure calculates the percent of time that stop bar detectors are occupied during the green phase and then during the first five seconds of red. It measures how often a vehicle does not make it through an intersection on the first green light they are given.</p>
<pre class="r"><code># Split Failure aggregation table: Split Failures
SF_flies &lt;- list(FtUnion = &quot;data/FtUnion/FtUnion_SplitFail.xls&quot;,
                 N800 = &quot;data/800N/800N_SplitFail.xls&quot;,
                 StateSt = &quot;data/StateSt/StateSt_SplitFail.xls&quot;)

SF &lt;- lapply(SF_flies, read_xls) %&gt;%
  bind_rows(.id = &quot;Corridor&quot;) %&gt;%
  mutate(
    BinStartTime = as_datetime(BinStartTime),
    SignalId = as.numeric(SignalId)
  ) %&gt;%
  write_rds(&quot;SF.rds&quot;)</code></pre>
</div>
<div id="purdue-phase-termination" class="section level4">
<h4>Purdue Phase Termination</h4>
<p>The Purdue Phase Termination is a tool for evaluating performance measures that plots the controller’s phases and the reason the phase terminated. It does not require detection. The phase termination due to force off, gap out, or max out and identifies where split time may need to be added or subtracted from a phase</p>
<pre class="r"><code># Purdue Phase Termination Diagram aggregation table: Max out, Gap out, and Force Off
PPT_flies &lt;- list(FtUnion = &quot;data/FtUnion/FtUnion_PPT.xls&quot;,
                 N800 = &quot;data/800N/800N_PPT.xls&quot;,
                 StateSt = &quot;data/StateSt/StateSt_PPT.xls&quot;)

PPT &lt;- lapply(PPT_flies, read_xls) %&gt;%
  bind_rows(.id = &quot;Corridor&quot;) %&gt;%
  mutate(
    BinStartTime = as_datetime(BinStartTime),
    SignalId = as.numeric(SignalId)
  ) %&gt;%
  write_rds(&quot;PPT.rds&quot;)</code></pre>
</div>
<div id="number-of-cycles" class="section level4">
<h4>Number of Cycles</h4>
<p>The Number of Cycles table is to indicate the number of cycles for each intersections in 15-min bins. It will help to calculate the percentage of gap out, force off,and split failures in 15-min bins.</p>
<pre class="r"><code>#  Cycles Number: Number of Cycles
Cyc_flies &lt;- list(FtUnion = &quot;data/FtUnion/FtUnion_Cycles.xls&quot;,
                 N800 = &quot;data/800N/800N_Cycles.xls&quot;,
                 StateSt = &quot;data/StateSt/StateSt_Cycles.xls&quot;)

Cyc &lt;- lapply(Cyc_flies, read_xls) %&gt;%
  bind_rows(.id = &quot;Corridor&quot;) %&gt;%
  mutate(
    BinStartTime = as_datetime(BinStartTime),
    SignalId = as.numeric(SignalId)
  ) %&gt;%
  write_rds(&quot;Cyc.rds&quot;)</code></pre>
</div>
<div id="basetable" class="section level4">
<h4>BaseTable</h4>
<p>The Base Table includes BinStartTime, SignalID, and ApproachID. It will help to aggreate all other tables into one table.</p>
<pre class="r"><code># BaseTable for Corridors: BinStartTime, SignalID, and ApproachID
BaseTable_FtUnion &lt;-read_xls(&quot;data/FtUnion/FtUnion_BaseTable.xls&quot;) %&gt;%
  mutate(
    BinStartTime = as_datetime(BinStartTime),
    SignalId = as.numeric(SignalId),
    ApproachId = as.numeric(ApproachId),
  )

BaseTable_800N &lt;-read_xls(&quot;data/800N/800N_BaseTable.xls&quot;) %&gt;%
  mutate(
    BinStartTime = as_datetime(BinStartTime),
    SignalId = as.numeric(SignalId),
    ApproachId = as.numeric(ApproachId),
  )

BaseTable_StateSt &lt;-read_xls(&quot;data/StateSt/StateSt_BaseTable.xls&quot;) %&gt;%
  mutate(
    BinStartTime = as_datetime(BinStartTime),
    SignalId = as.numeric(SignalId),
    ApproachId = as.numeric(ApproachId),
  )

BaseTable &lt;- rbind(BaseTable_800N, BaseTable_FtUnion, BaseTable_StateSt) %&gt;%
  write_rds(&quot;BaseTable.rds&quot;)</code></pre>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
